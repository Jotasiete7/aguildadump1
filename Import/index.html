<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>A Guilda - Dashboard NFI 2025</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #f4f6f9; --text: #1a1a1a; --card: #fff;
      --green: #2e8b57; --red: #c0392b; --blue: #3498db;
      --accent: #27ae60; --dark: #2c3e50;
      --table-header: #f8f9fa; --table-header-text: #1a1a1a;
      --warning-bg: #fff3cd; --warning-text: #856404;
      --purple: #8e44ad;
    }
    .dark {
      --bg: #1a1a1a; --text: #f4f6f9; --card: #2c3e50;
      --table-header: #34495e; --table-header-text: #ecf0f1;
      --warning-bg: #856404; --warning-text: #fff;
    }
    body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; }
    header { background: var(--dark); color: white; padding: 1rem; text-align: center; position: relative; }
    .toggle {
      position: absolute; top: 1rem; right: 1rem;
      background: #fff; color: #000;
      border: none; padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer;
      font-weight: bold;
    }
    .dark .toggle { background: #333; color: #fff; }
    .container { max-width: 1200px; margin: auto; padding: 1rem; }
    .controls {
      display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem;
      background: var(--card); padding: 1rem; border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1); align-items: center;
    }
    select, input, button {
      padding: 0.6rem; border-radius: 8px; border: 1px solid #ddd; font-size: 1rem;
    }
    button {
      background: var(--accent); color: white; border: none; cursor: pointer;
      font-weight: bold; display: flex; align-items: center; gap: 0.5rem;
    }
    button:hover { background: #219653; }
    button.recipes { background: var(--purple); }
    button.recipes:hover { background: #7d3c98; }
    .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }
    .card { background: var(--card); padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: 0.8rem; text-align: left; border-bottom: 1px solid #eee; }
    th {
      background: var(--table-header) !important;
      color: var(--table-header-text) !important;
      cursor: pointer; user-select: none;
    }
    .dark th { border-bottom: 1px solid #4a5568; }
    th:hover { background: #e9ecef !important; }
    .dark th:hover { background: #3d566e !important; }
    .up { color: var(--green); font-weight: bold; }
    .down { color: var(--red); font-weight: bold; }
    .stable { color: var(--blue); }
    .chart-container { position: relative; height: 300px; }
    .opportunities { background: #d1ecf1; padding: 1rem; border-radius: 12px; margin-top: 1rem; display: none; }
    .dark .opportunities { background: #0c5460; color: #d1ecf1; }
    .export { margin-top: 1rem; text-align: center; font-size: 0.9rem; color: #666; }
    .dark .export { color: #aaa; }
    /* === BOTÃO ANÁLISE DE ARMAS 2025 === */
    .weapons-box {
      background: var(--warning-bg); color: var(--warning-text);
      padding: 1.2rem; border-radius: 12px; margin: 1rem 0;
      border-left: 5px solid #f39c12; font-size: 0.95rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .dark .weapons-box { background: #7f6a00; color: #fff; border-left-color: #f1c40f; }
    .weapons-box h4 {
      margin: 0 0 0.8rem; font-size: 1.2rem; display: flex; align-items: center; gap: 0.5rem;
    }
    .weapons-box .btn {
      display: inline-block; margin-top: 0.8rem;
      background: #f39c12; color: white; padding: 0.6rem 1.2rem;
      border-radius: 8px; text-decoration: none; font-weight: bold;
      font-size: 0.95rem;
    }
    .weapons-box .btn:hover { background: #e67e22; }
    .dark .weapons-box .btn { background: #f1c40f; color: #000; }
    .dark .weapons-box .btn:hover { background: #f39c12; }
  </style>
</head>
<body>
  <header>
    <h1>A GUILDA - DASHBOARD DE PREÇOS NFI 2025</h1>
    <button class="toggle" onclick="document.body.classList.toggle('dark')">Modo Escuro</button>
  </header>
  <div class="container">
    <!-- === AVISO + BOTÃO ANÁLISE DE ARMAS === -->
    <div class="weapons-box">
      <h4>Análise de Armas 2025 (Beta)</h4>
      <p>
        <strong>ATENÇÃO:</strong> Esta é uma análise <strong>não definitiva</strong>, baseada em dados da Wurmpedia e discussões da comunidade até <strong>outubro de 2025</strong>.<br>
        <strong>Podem haver pequenos erros</strong> de cálculo, interpretação ou mudanças futuras no jogo. <strong>Teste tudo no jogo antes de investir!</strong><br>
        <em>Estamos sempre atualizando — sua paciência e feedback ajudam a melhorar!</em>
      </p>
      <a href="weapons-guide.html" class="btn">Abrir Análise de Armas 2025</a>
    </div>

    <div class="controls">
      <input type="text" id="search" placeholder="Buscar item..." onkeyup="filterTable()">
      <select id="category" onchange="filterTable()">
        <option value="">Todas Categorias</option>
      </select>
      <select id="confidence" onchange="filterTable()">
        <option value="">Todas Confianças</option>
        <option value="Alta">Alta</option>
        <option value="Média">Média</option>
        <option value="Baixa">Baixa</option>
      </select>
      <button onclick="showOpportunities()">Oportunidades de Comp  <button class="recipes" onclick="window.open('recipes.html', '_blank')">
        Recipes Guide
      </button>
    </div>

    <div class="grid">
      <div class="card">
        <h3>Variação de Preços (Top 10)</h3>
        <div class="chart-container">
          <canvas id="chart"></canvas>
        </div>
      </div>
      <div class="card">
        <h3>Itens em Alta</h3>
        <div id="upItems"></div>
      </div>
    </div>

    <div class="card">
      <h3>Tabela de Preços</h3>
      <table id="priceTable">
        <thead>
          <tr>
            <th onclick="sortTable(0)">Item</th>
            <th onclick="sortTable(1)">Cat.</th>
            <th onclick="sortTable(2)">2024</th>
            <th onclick="sortTable(3)">2025</th>
            <th onclick="sortTable(4)">Var.</th>
            <th onclick="sortTable(5)">Indicador</th>
            <th onclick="sortTable(6)">Conf.</th>
            <th onclick="sortTable(7)">Venda</th>
          </tr>
        </thead>
        <tbody id="tableBody"></tbody>
      </table>
    </div>

    <div id="opportunities" class="opportunities">
      <h3>Oportunidades de Compra (+ Confiança Alta)</h3>
      <div id="oppList"></div>
    </div>

    <div class="export">
      <small>Atualizado: 31/10/2025 | Feito com amor por <strong>A Guilda</strong></small>
    </div>
  </div>

  <script>
    // === TODOS OS DADOS DA GUILDA (COMPLETO) ===
    const data = [
      ["Stone Bricks (1k)","Bulk",175,168,-4.0,"●","Alta",193,"Estável, manter margem"],
      ["Rounded Stone Bricks (1k)","Bulk",175,170,-2.9,"●","Alta",196,"Estável"],
      ["Stone Shards (Low QL, 1k)","Bulk",10,11,10.0,"▲","Alta",13,"Inflação leve"],
      ["Stone Shards (High QL, 1k)","Bulk",100,95,-5.0,"●","Alta",109,"Estável"],
      ["Marble Shards (1k)","Bulk",175,180,2.9,"●","Alta",207,"Luxo estável"],
      ["Slate Shards (1k)","Bulk",175,178,1.7,"●","Alta",205,"Decoração"],
      ["Sandstone Bricks (1k)","Bulk",350,360,2.9,"●","Média",414,"Luxo"],
      ["Pottery Bricks (1k)","Bulk",350,355,1.4,"●","Média",408,"Estável"],
      ["Ribbons (100)","Bulk",100,105,5.0,"▲","Alta",121,"Runas em alta"],
      ["Support Beams (100)","Bulk",500,520,4.0,"●","Alta",598,"Construção constante"],
      ["Wooden Beams (1k)","Bulk",250,240,-4.0,"●","Alta",276,"Estável"],
      ["Kindling (1k)","Bulk",125,130,4.0,"●","Média",150,"Fogo constante"],
      ["Planks (Creation QL, 1k)","Bulk",150,155,3.3,"●","Alta",178,"Carpintaria"],
      ["Nails (1k)","Bulk",200,195,-2.5,"●","Alta",224,"Estável"],
      ["Clay (Low QL, 1k)","Bulk",75,80,6.7,"▲","Alta",92,"Pottery em alta"],
      ["Clay (High QL, 1k)","Bulk",150,160,6.7,"▲","Alta",184,"Alta qualidade"],
      ["Mortar (1k)","Bulk",350,320,-8.6,"▼","Alta",368,"Queda de preço, vender estoque"],
      ["Ash >70QL (1k)","Bulk",300,310,3.3,"●","Alta",357,"Alchemy"],
      ["Ash >80QL (1k)","Bulk",400,420,5.0,"▲","Alta",483,"Alta demanda"],
      ["Tar (1k)","Bulk",75,78,4.0,"●","Alta",90,"Estável"],
      ["Ores/Lumps Low QL (1k)","Bulk",125,130,4.0,"●","Alta",150,"Mineração"],
      ["Fence Bars (100)","Bulk",250,260,4.0,"●","Alta",299,"Fazendas"],
      ["Charcoal Low QL (1k)","Bulk",200,205,2.5,"●","Alta",236,"Estável"],
      ["Charcoal High QL (1k)","Bulk",500,520,4.0,"●","Alta",598,"Forjas ativas"],
      ["Logs Low QL (1k)","Bulk",40,42,5.0,"▲","Alta",48,"Inflação"],
      ["Logs 90QL","Misc",1,1.2,20.0,"▲","Alta",1,"Alta QL valoriza"],
      ["Logs 95QL","Misc",2,2.3,15.0,"▲","Alta",3,"Alta QL"],
      ["Logs 99QL","Misc",5,5.8,16.0,"▲","Alta",7,"Raro"],
      ["Cotton/Wemp Low QL (1k)","Bulk",75,78,4.0,"●","Alta",90,"Estável"],
      ["Cotton/Wemp High QL (1k)","Bulk",150,158,5.3,"▲","Alta",182,"Tailoring"],
      ["Foraged/Botanized Low QL (1k)","Bulk",90,95,5.6,"▲","Alta",109,"Farms"],
      ["Foraged/Botanized High QL (1k)","Bulk",125,132,5.6,"▲","Alta",152,"Alta QL"],
      ["Animal Bits (1k)","Bulk",100,105,5.0,"▲","Alta",121,"Alchemy"],
      ["Sprouts (100)","Bulk",100,105,5.0,"▲","Alta",121,"Fazendas"],
      ["Dirt/Sand (1k)","Bulk",175,180,2.9,"●","Alta",207,"Terrenos"],
      ["Meat (1k)","Bulk",100,102,2.0,"●","Alta",117,"Estável"],
      ["Favor (1k)","Bulk",125,130,4.0,"●","Alta",150,"Priests"],
      ["Concrete (100)","Bulk",250,240,-4.0,"●","Alta",276,"Estável"],
      ["Iron Lumps 95QL (64kg)","Misc",50,55,10.0,"▲","Alta",63,"Blacksmith"],
      ["Iron Lumps 100QL (64kg)","Misc",100,110,10.0,"▲","Alta",127,"Alta QL"],
      ["Steel Lumps 80QL (64kg)","Misc",500,520,4.0,"●","Média",598,"Raro"],
      ["Steel Lumps 90QL (64kg)","Misc",900,950,5.6,"▲","Média",1093,"Alta QL"],
      ["Moonmetal Lump 80QL","Misc",275,285,3.6,"●","Média",328,"Raro"],
      ["Rift Mats (per QL)","Misc",25,28,12.0,"▲","Alta",32,"Rifts"],
      ["Rift Points (100)","Misc",100,105,5.0,"▲","Alta",121,"Eventos"],
      ["Star Gem Low QL","Misc",100,105,5.0,"▲","Alta",121,"Jóias"],
      ["Star Gem High QL","Misc",300,330,10.0,"▲","Alta",380,"Raro"],
      ["Sleep Powder","Misc",75,78,4.0,"●","Alta",90,"Estável, manter estoque"],
      ["Yellow Potion","Misc",5,3,-40.0,"▼","Baixa",3,"Sem valor, sacc ou descartar"],
      ["Valrei Item","Misc",15,18,20.0,"▲","Alta",21,"Missões"],
      ["Bouquet of White-Dotted Flowers","Misc",50,52,4.0,"●","Média",60,"Decoração"],
      ["Beeswax","Misc",3,3.5,16.7,"▲","Média",4,"Estável"],
      ["Event Item","Misc",100,105,5.0,"▲","Média",121,"Temporário"],
      ["Pottery Spring Flowers","Misc",400,420,5.0,"▲","Média",483,"Decoração"],
      ["Kahvesi 90QL+ (sm. barrel)","Misc",100,105,5.0,"▲","Alta",121,"Affinity em alta"],
      ["24hr Affinity Alcohol (sm. barrel)","Misc",200,220,10.0,"▲","Alta",253,"Demanda constante"],
      ["Milk (sm. barrel)","Misc",40,42,5.0,"▲","Média",48,"Farms"],
      ["Gems (-10QL)","Misc",1,1.1,10.0,"▲","Alta",1,"QL importa"],
      ["Gems (+10QL)","Misc",12.5,14,12.0,"▲","Alta",16,"QL alto"],
      ["Source Crystal","Misc",250,260,4.0,"●","Alta",299,"Magia"],
      ["Drake Hide (.01kg)","Raros",110,98,-10.9,"▼","Média",113,"Oferta alta, reduzir preço"],
      ["Dragon Scale (.01kg)","Raros",150,138,-8.0,"▼","Baixa",159,"Menos demanda"],
      ["CCFP Filler Food (2kg 90QL+)","Misc",2.5,2.7,8.0,"▲","Alta",3,"Estável"],
      ["Rare Strange Bone Fragment","RarosExpiry",275,300,9.1,"▲","Média",345,"Sacrificar ou vender"],
      ["Holiday Fragment","Misc",25,28,12.0,"▲","Média",32,"Eventos"],
      ["Blessed Water Skin","Misc",1350,1400,3.7,"●","Média",1610,"Raro"],
      ["Sacc Value (junk rare)","Misc",4,4.5,12.5,"▲","Média",5,"Sacrificar"],
      ["Treasure Map 1-29QL","Misc",80,85,6.3,"▲","Média",98,"Risco"],
      ["Treasure Map 30-59QL","Misc",150,160,6.7,"▲","Média",184,"Médio"],
      ["Treasure Map 60-100QL","Misc",250,270,8.0,"▲","Média",311,"Alto risco"],
      ["Rare Bone","Raros",3250,3500,7.7,"▲","Média",4025,"Sacrificar ou vender"],
      ["Supreme Bone","Raros",135000,180000,33.3,"▲","Média",207000,"Raro em alta! Priorizar venda"],
      ["Bracelet of Inspiration","Misc",2750,2800,1.8,"●","Média",3220,"Raro útil"],
      ["Black Dragon Blood","Potions",250,260,4.0,"●","Média",299,"Potion of Carpentry"],
      ["Black Dragon Hatchling Blood","Potions",250,255,2.0,"●","Média",293,"Oil of Armoursmith"],
      ["Kyklops Blood","Potions",250,260,4.0,"●","Média",299,"Potion of Leatherworking"],
      ["Goblin Leader Blood","Potions",250,255,2.0,"●","Média",293,"Potion of Mining"],
      ["Troll King Blood","Potions",250,260,4.0,"●","Média",299,"Ointment of Stonecutting"],
      ["Green Dragon Blood","Potions",300,310,3.3,"●","Média",357,"Ointment of Tailoring"],
      ["White Dragon Blood","Potions",250,255,2.0,"●","Média",293,"Oil of Blacksmith"],
      ["Red Dragon Blood","Potions",250,260,4.0,"●","Média",299,"Potion of Ropemaking"],
      ["Red Dragon Hatchling Blood","Potions",250,255,2.0,"●","Média",293,"Oil of Weaponsmith"],
      ["Blue Dragon Hatchling Blood","Potions",150,155,3.3,"●","Média",178,"Fletching Potion"],
      ["Blue Dragon Blood","Potions",900,920,2.2,"●","Média",1058,"Potion of Butchery"],
      ["Forest Giant Blood","Potions",250,260,4.0,"●","Média",299,"Potion of Woodcutting"],
      ["Strongwall (per tile)","Enchants",50,52,4.0,"●","Alta",60,"Priest service"],
      ["Courier/Dark Messenger","Enchants",150,160,6.7,"▲","Alta",184,"Cast"],
      ["BoTD 80","Enchants",80,85,6.3,"▲","Alta",98,"Estável"],
      ["BoTD 90","Enchants",125,140,12.0,"▲","Alta",161,"Alta demanda"],
      ["CoC 80","Enchants",80,85,6.3,"▲","Alta",98,"Estável"],
      ["CoC 90","Enchants",100,108,8.0,"▲","Alta",124,"Skills"],
      ["LT 80","Enchants",100,105,5.0,"▲","Média",121,"Arqueiros"],
      ["LT 90","Enchants",150,165,10.0,"▲","Alta",190,"Alta"],
      ["AOSP 80","Enchants",80,83,3.8,"●","Média",95,"Estável"],
      ["AOSP 90","Enchants",100,105,5.0,"▲","Média",121,"Estável"],
      ["WoA 80","Enchants",80,85,6.3,"▲","Alta",98,"Transporte"],
      ["WoA 90","Enchants",100,112,12.0,"▲","Alta",129,"Alta"],
      ["Enchanted Grass/Lava Tile","Enchants",75,80,6.7,"▲","Média",92,"Travel fee extra"],
      ["Smelter (Creation QL)","Masonry",250,260,4.0,"●","Alta",299,"Estável"],
      ["Forge (80ql+)","Masonry",250,255,2.0,"●","Alta",293,"Estável"],
      ["Guard Tower","Masonry",450,470,4.4,"●","Média",541,"Segurança"],
      ["Catseye","Masonry",1.5,1.7,13.3,"▲","Média",2,"Decoração"],
      ["Halter Rope","Ropemaking",1,1.2,20.0,"▲","Média",1,"Estável"],
      ["Rope (1k)","Ropemaking",100,102,2.0,"●","Alta",117,"Estável"],
      ["Cordage Rope","Ropemaking",0,0,0,"","Baixa",0,"Favor only"],
      ["Full Chain Set 70QL (Iron)","Armour",100,105,5.0,"▲","Alta",121,"Estável"],
      ["Full Chain Set 80QL (Iron)","Armour",200,210,5.0,"▲","Alta",242,"Estável"],
      ["Full Chain Set 90QL (Iron)","Armour",450,470,4.4,"●","Alta",541,"Alta"],
      ["Full Chain Set (Steel)","Armour",900,950,5.6,"▲","Média",1093,"2x iron"],
      ["Full Plate Set 70QL (Iron)","Armour",200,210,5.0,"▲","Alta",242,"Estável"],
      ["Full Plate Set 80QL (Iron)","Armour",300,315,5.0,"▲","Alta",362,"Estável"],
      ["Full Plate Set 90QL (Iron)","Armour",400,420,5.0,"▲","Alta",483,"Alta"],
      ["Full Plate Set (Steel)","Armour",800,850,6.3,"▲","Média",978,"2x iron"],
      ["Demon Helm","Armour",300,310,3.3,"●","Média",357,"Estético"],
      ["Weapon Imp 70QL (Iron)","Weapon",30,32,6.7,"▲","Alta",37,"Estável"],
      ["Weapon Imp 80QL (Iron)","Weapon",50,53,6.0,"▲","Alta",61,"Estável"],
      ["Weapon Imp 90QL (Iron)","Weapon",100,108,8.0,"▲","Alta",124,"Alta"],
      ["Weapon Imp 95QL (Iron)","Weapon",200,215,7.5,"▲","Alta",247,"Alta QL"],
      ["Weapon Imp (Silver)","Weapon",200,215,7.5,"▲","Média",247,"2x iron"],
      ["Tool Imp 80QL (Iron)","Blacksmithing",20,22,10.0,"▲","Alta",25,"Estável"],
      ["Tool Imp 90QL (Iron)","Blacksmithing",75,82,9.3,"▲","Alta",94,"Alta"],
      ["Tool Imp 95QL (Iron)","Blacksmithing",200,215,7.5,"▲","Alta",247,"Alta QL"],
      ["Tool Imp (Steel)","Blacksmithing",400,430,7.5,"▲","Média",495,"2x iron"],
      ["Tool (Creation QL)","Blacksmithing",2.5,3,20.0,"▲","Média",3,"Varia"],
      ["Horse Shoe 90QL","Blacksmithing",50,55,10.0,"▲","Alta",63,"Transporte"],
      ["Lamp 50QL+","Blacksmithing",50,52,4.0,"●","Média",60,"Decoração"],
      ["Dioptra (Creation QL)","Carpentry",75,80,6.7,"▲","Média",92,"Survey"],
      ["Large Crate","Carpentry",12.5,13,4.0,"●","Alta",15,"Estável"],
      ["BSB","Carpentry",5,5.5,10.0,"▲","Alta",6,"Estável"],
      ["Creature Cage","Carpentry",75,80,6.7,"▲","Média",92,"Animal"],
      ["Pantry","Carpentry",100,105,5.0,"▲","Média",121,"Estável"],
      ["Bulk Container Unit","Carpentry",150,155,3.3,"●","Média",178,"Estável"],
      ["Beehive","Carpentry",100,105,5.0,"▲","Média",121,"Farms"],
      ["Cloth Imp 70QL","Tailoring",50,53,6.0,"▲","Alta",61,"Estável"],
      ["Cloth Imp 80QL","Tailoring",100,108,8.0,"▲","Alta",124,"Alta"],
      ["Cloth Imp 90QL","Tailoring",150,162,8.0,"▲","Alta",186,"Alta"],
      ["Cloth Imp 95QL","Tailoring",200,215,7.5,"▲","Alta",247,"Alta QL"],
      ["Leather Imp 80QL","Tailoring",50,53,6.0,"▲","Alta",61,"Estável"],
      ["Leather Imp 90QL","Tailoring",100,108,8.0,"▲","Alta",124,"Alta"],
      ["Leather Imp 95QL","Tailoring",200,215,7.5,"▲","Alta",247,"Alta QL"],
      ["Studded Set 80QL","Tailoring",100,105,5.0,"▲","Alta",121,"Estável"],
      ["Studded Set 90QL","Tailoring",200,210,5.0,"▲","Alta",242,"Alta"],
      ["Toolbelt 90QL","Tailoring",125,132,5.6,"▲","Alta",152,"Utilidade"],
      ["Saddle 80QL","Tailoring",50,53,6.0,"▲","Média",61,"Estável"],
      ["Saddle 90QL","Tailoring",100,108,8.0,"▲","Média",124,"Alta"],
      ["Almanac","Tailoring",100,105,5.0,"▲","Média",121,"Farming"],
      ["Meditation Rug (Creation QL)","Tailoring",4,4.5,12.5,"▲","Média",5,"Skill"],
      ["Knarr","Shipbuilding",1350,1420,5.2,"▲","Alta",1633,"Demanda por transporte"],
      ["Corbita","Shipbuilding",250,260,4.0,"●","Média",299,"Estável"],
      ["Wagon (normal wood)","Carpentry",250,260,4.0,"●","Alta",299,"Archwood +1s"],
      ["Large Cart (normal wood)","Carpentry",100,105,5.0,"▲","Alta",121,"Transporte"],
      ["Arch Shaft","Arch",50,52,4.0,"●","Média",60,"Arqueologia"],
      ["Arch Plank","Arch",100,105,5.0,"▲","Média",121,"Raro"],
      ["Arch Peg/Tenon","Arch",20,22,10.0,"▲","Média",25,"Raro"],
      ["Unid'd Fragment (1k)","Arch",400,420,5.0,"▲","Média",483,"Risco alto"],
      ["Statue Frags","Arch",17.5,20,14.3,"▲","Média",23,"Arqueologia"],
      ["Statuette Full Set","Arch",100,110,10.0,"▲","Média",127,"Coleção"],
      ["Mask","Arch",25,28,12.0,"▲","Média",32,"Decoração"],
      ["Rare Large Nail","Raros",75,92,22.7,"▲","Alta",106,"Comprar em bulk"],
      ["Rare Small Nail","Raros",75,88,17.3,"▲","Alta",101,"Alta demanda"],
      ["Rare Ribbon","Raros",75,85,13.3,"▲","Média",98,"Runas"],
      ["Rare Rope","Raros",50,48,-4.0,"●","Baixa",55,"Monitorar"],
      ["Rare Plank","Raros",100,102,2.0,"●","Alta",117,"Estável"],
      ["Rare Shaft","Raros",100,101,1.0,"●","Alta",116,"Estável"],
      ["Rare Peg","Raros",35,42,20.0,"▲","Média",48,"Carpintaria"],
      ["Rare Sprout","Raros",35,40,14.3,"▲","Média",46,"Farms"],
      ["Rare Clay","Raros",75,82,9.3,"▲","Alta",94,"Pottery"],
      ["Rare Brick","Raros",60,68,13.3,"▲","Média",78,"Construção"],
      ["Rare Leather","Raros",125,115,-8.0,"▼","Alta",132,"Oferta alta"],
      ["Rare Tar","Raros",35,38,8.6,"▲","Média",44,"Estável"],
      ["Rare Lump (Iron)","Raros",20,25,25.0,"▲","Alta",29,"Blacksmith"],
      ["Rare Lump (Silver)","Raros",30,35,16.7,"▲","Média",40,"Jóias"],
      ["Rare Lump (Copper)","Raros",20,24,20.0,"▲","Média",28,"Estável"],
      ["Rare Lump (Lead)","Raros",20,23,15.0,"▲","Média",26,"Estável"],
      ["Rare Lump (Tin)","Raros",20,24,20.0,"▲","Média",28,"Estável"],
      ["Rare Lump (Zinc)","Raros",20,25,25.0,"▲","Média",29,"Estável"],
      ["Rare Lump (Gold)","Raros",30,36,20.0,"▲","Média",41,"Luxo"],
      ["Rare Dirt","Raros",15,20,33.3,"▲","Baixa",23,"Monitorar"],
      ["Rare Sand","Raros",15,19,26.7,"▲","Baixa",22,"Vidro"],
      ["Rare Mortar","Raros",25,28,12.0,"▲","Média",32,"Construção"],
      ["Rare Log","Raros",15,18,20.0,"▲","Média",21,"Carpintaria"],
      ["Rare Forge","Raros",1100,1250,13.6,"▲","Média",1438,"Raro útil"],
      ["Rare Large Cart","Raros",2750,2950,7.3,"▲","Alta",3393,"Transporte"],
      ["Rare Wagon","Raros",3500,3800,8.6,"▲","Alta",4370,"Archwood + runas"],
      ["Rare Stone Shard","Raros",15,18,20.0,"▲","Média",21,"Masonry"],
      ["Rare Slate Shard","Raros",15,17,13.3,"▲","Média",20,"Decoração"],
      ["Rare Marble Shard","Raros",15,19,26.7,"▲","Média",22,"Luxo"]
    ];

    // === CATEGORIAS ===
    const categories = [...new Set(data.map(row => row[1]))].sort();
    const categorySelect = document.getElementById("category");
    categories.forEach(cat => {
      const opt = document.createElement("option");
      opt.value = cat; opt.textContent = cat;
      categorySelect.appendChild(opt);
    });

    // === RENDER TABELA ===
    function renderTable(filtered = data) {
      const tbody = document.getElementById("tableBody");
      tbody.innerHTML = "";
      filtered.forEach(row => {
        const tr = document.createElement("tr");
        row.forEach((cell, i) => {
          const td = document.createElement("td");
          if (i === 5) {
            td.innerHTML = cell === "▲" ? `<span class="up">${cell}</span>` :
                          cell === "▼" ? `<span class="down">${cell}</span>` :
                          `<span class="stable">${cell}</span>`;
          } else if (i >= 2 && i <= 3 || i === 7) {
            td.textContent = cell > 1000 ? (cell/100).toFixed(2) + "s" : cell + "c";
          } else {
            td.textContent = cell;
          }
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    // === FILTROS ===
    function filterTable() {
      const search = document.getElementById("search").value.toLowerCase();
      const cat = document.getElementById("category").value;
      const conf = document.getElementById("confidence").value;
      const filtered = data.filter(row => {
        const matchesSearch = row[0].toLowerCase().includes(search);
        const matchesCat = !cat || row[1] === cat;
        const matchesConf = !conf || row[6] === conf;
        return matchesSearch && matchesCat && matchesConf;
      });
      renderTable(filtered);
      updateChart(filtered);
      updateUpItems(filtered);
    }

    // === GRÁFICO ===
    function updateChart(items) {
      const ctx = document.getElementById("chart").getContext("2d");
      const top10 = items.sort((a,b) => b[4] - a[4]).slice(0,10);
      if (window.myChart) window.myChart.destroy();
      window.myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: top10.map(r => r[0].substring(0,20) + (r[0].length > 20 ? "..." : "")),
          datasets: [{
            label: 'Variação %',
            data: top10.map(r => r[4]),
            backgroundColor: top10.map(r => r[5] === "▲" ? '#2e8b57' : r[5] === "▼" ? '#c0392b' : '#3498db'),
            borderRadius: 6
          }]
        },
        options: { responsive: true, plugins: { legend: { display: false } } }
      });
    }

    // === ITENS EM ALTA ===
    function updateUpItems(items) {
      const up = items.filter(r => r[5] === "▲").slice(0, 8);
      const container = document.getElementById("upItems");
      container.innerHTML = up.map(r => `<p><strong>${r[0]}</strong>: +${r[4]}% → ${r[3] > 1000 ? (r[3]/100).toFixed(2)+'s' : r[3]+'c'}</p>`).join("");
    }

    // === OPORTUNIDADES ===
    function showOpportunities() {
      const opps = data.filter(r => r[5] === "▼" && r[6] === "Alta");
      const list = document.getElementById("oppList");
      list.innerHTML = opps.map(r =>
        `<p><strong>${r[0]}</strong>: ${r[3]}c (era ${r[2]}c) → <em>Compre agora!</em></p>`
      ).join("");
      document.getElementById("opportunities").style.display = "block";
    }

    // === ORDENAÇÃO ===
    function sortTable(n) {
      const isNum = n >= 2 && n <= 4;
      data.sort((a, b) => {
        if (isNum) return a[n] - b[n];
        return a[n].localeCompare(b[n]);
      });
      filterTable();
    }

    // === INIT ===
    renderTable();
    updateChart(data);
    updateUpItems(data);
  </script>
</body>
</html>